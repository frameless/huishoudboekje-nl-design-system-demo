version: '3'

services:
  backend:
    build:
      context: backend
      args:
        COMPONENT_TAG: "${COMPONENT_TAG}"
        COMPONENT_COMMIT_HASH: "${COMPONENT_COMMIT_HASH}"
    image: "${IMAGE_PREFIX}backend:${IMAGE_TAG}"

  frontend:
    build:
      context: frontend
      args:
        COMPONENT_TAG: "${COMPONENT_TAG}"
        COMPONENT_COMMIT_HASH: "${COMPONENT_COMMIT_HASH}"
    image: "${IMAGE_PREFIX}frontend:${IMAGE_TAG}"

  huishoudboekje_service:
    build:
      context: services
      dockerfile: huishoudboekje_service/Dockerfile
      args:
        COMPONENT_TAG: "${COMPONENT_TAG}"
        COMPONENT_COMMIT_HASH: "${COMPONENT_COMMIT_HASH}"
    image: "${IMAGE_PREFIX}huishoudboekje-service:${IMAGE_TAG}"

  organisatie_service:
    build:
      context: services
      dockerfile: organisatie_service/Dockerfile
      args:
        COMPONENT_TAG: "${COMPONENT_TAG}"
        COMPONENT_COMMIT_HASH: "${COMPONENT_COMMIT_HASH}"
    image: "${IMAGE_PREFIX}organisatie-service:${IMAGE_TAG}"

  bank_transactie_service:
    build:
      context: services
      dockerfile: bank_transactie_service/Dockerfile
      args:
        COMPONENT_TAG: "${COMPONENT_TAG}"
        COMPONENT_COMMIT_HASH: "${COMPONENT_COMMIT_HASH}"
    image: "${IMAGE_PREFIX}bank-transactie-service:${IMAGE_TAG}"

  grootboek_service:
    build:
      context: services
      dockerfile: grootboek_service/Dockerfile
      args:
        COMPONENT_TAG: "${COMPONENT_TAG}"
        COMPONENT_COMMIT_HASH: "${COMPONENT_COMMIT_HASH}"
    image: "${IMAGE_PREFIX}grootboek-service:${IMAGE_TAG}"

  log_service:
    build:
      context: services
      dockerfile: log_service/Dockerfile
      args:
        COMPONENT_TAG: "${COMPONENT_TAG}"
        COMPONENT_COMMIT_HASH: "${COMPONENT_COMMIT_HASH}"
    image: "${IMAGE_PREFIX}log-service:${IMAGE_TAG}"

  python-postgres:
    build:
      context: python-postgres
    image: "${IMAGE_PREFIX}python-postgres:${IMAGE_TAG}"

  sample_data:
    build:
      context: sample_data
      args:
        COMPONENT_TAG: "${COMPONENT_TAG}"
        COMPONENT_COMMIT_HASH: "${COMPONENT_COMMIT_HASH}"
    image: "${IMAGE_PREFIX}sample_data:${IMAGE_TAG}"

networks:
  default:
    driver: bridge
    driver_opts:
      com.docker.network.driver.mtu: 1454